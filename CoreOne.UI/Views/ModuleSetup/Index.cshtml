@model CoreOne.DOMAIN.Models.MenuWithModulesSave

@using CoreOne.DOMAIN.Models
@{
    ViewData["Title"] = "Menu Module Master";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int pageNumber = ViewBag.PageNumber ?? 1;
    int pageSize = ViewBag.PageSize ?? 10;
    int totalRecords = ViewBag.TotalRecords ?? 0;
    int totalPages = (int)Math.Ceiling(totalRecords / (double)pageSize);

    string search = ViewBag.Search ?? "";
    string sortColumn = ViewBag.SortColumn ?? "MenuName";
    string sortDir = ViewBag.SortDir ?? "ASC";
    string searchCol = ViewBag.SearchCol ?? "MenuName";

    var modules = ViewBag.MenuModules as List<MenuModuleDto> ?? new List<MenuModuleDto>();

    int maxWindow = 5;
    int startPage = 1;
    int endPage = totalPages;
    if (totalPages > maxWindow)
    {
        int half = maxWindow / 2;
        startPage = pageNumber - half;
        endPage = pageNumber + half;
        if (startPage < 1) { startPage = 1; endPage = maxWindow; }
        else if (endPage > totalPages) { endPage = totalPages; startPage = totalPages - maxWindow + 1; }
    }
    else { startPage = 1; endPage = totalPages; }
}

<link href="~/css/modulesetup.css" rel="stylesheet" />

<style>
    /* 🔄 Preloader Styles */
    #preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(13, 20, 35, 0.95);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        transition: opacity 0.6s ease, visibility 0.6s ease;
    }

        #preloader.hidden {
            opacity: 0;
            visibility: hidden;
        }

    .loader {
        text-align: center;
    }

        .loader .spin {
            font-size: 48px;
            color: #89a4cd;
            animation: spin 2s linear infinite;
        }

    .loading-text {
        color: #ffffffcc;
        margin-top: 10px;
        font-weight: 500;
        letter-spacing: 1px;
    }
</style>

<!-- 🔄 Preloader -->
<div id="preloader">
    <div class="loader">
        <i class="fas fa-globe logo-icon spin"></i>
        <div class="loading-text">Loading...</div>
    </div>
</div>
<div class="container-fluid  p-2" style="background:rgba(255, 255, 255, 0.08);">

    <div class="row" style="margin-top: -19px; margin-bottom: -6px;">
        <div class="col-12">
            <div class="page-title-box">
                <div class="page-title-right">
                    <ol class="breadcrumb m-0">
                        <li class="breadcrumb-item"><a href="javascript:void(0);">SetUp</a></li>
                        <li class="breadcrumb-item"><a href="javascript:void(0);">Dashboard</a></li>
                        
                    </ol>
                </div>
                <h4 class="page-title">Module SetUp</h4>
            </div>
        </div>
    </div>


    <div class="card" style="background:rgba(255, 255, 255, 0.08);border-radius: 9px; border: 1px solid #b1d8ff; backdrop-filter: blur(12px);
                 -webkit-backdrop-filter: blur(12px); border-radius: 16px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2); color: white;">
    <div class="card-body">

            <div class="row align-items-center p-2 mb-2" style="background:rgba(255, 255, 255, 0.08); border-radius: 9px; border: 1px solid #b1d8ff; backdrop-filter: blur(12px);
                 -webkit-backdrop-filter: blur(12px); border-radius: 16px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2); color: white;">
                <div class="row justify-content-between">

                    <div class="col-auto">
                    <button type="button" class="btn btn-blue waves-effect waves-light" style="background: linear-gradient(135deg, #8173fa, #5a48e5);border-radius: 11px;"
                            onclick="window.location.href='/ModuleSetup/Index'">
                        <i class="mdi mdi-refresh-circle"></i> Refresh
                    </button>
                </div>



                    <div class="col-auto">
                    <button type="button" class="btn btn-success float-end" data-bs-toggle="modal" data-bs-target="#moduleSetupModal" style="background: linear-gradient(135deg, #13dc72, #004993);    border-radius: 11px;">
                        <i class="mdi mdi-plus-circle"></i> Create Module SetUp
                    </button>
                </div>
                </div>

            </div>

            <div class="row align-items-center p-2" style="background:rgba(255, 255, 255, 0.08); border-radius: 9px; border: 1px solid #b1d8ff; backdrop-filter: blur(12px);
                 -webkit-backdrop-filter: blur(12px); border-radius: 16px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2); color: white;">
                <div class="col-md-3">
                    <input type="search" id="searchBox" value="@search" class="form-control my-1 my-lg-0" placeholder="Search..." style="border-radius: 11px;  background: linear-gradient(135deg, #f8fbff, #ffffff);" />
                </div>
                <div class="col-md-2">
                    <select class="form-select my-1 my-lg-0" id="searchField" style="  background: linear-gradient(135deg, #f8fbff, #ffffff);   border-radius: 11px;">
                        @{
                            string[] searchableFields = { "MenuName", "ModuleName" };
                            string[] searchableNames = { "Menu", "Modules" };
                            for (int i = 0; i < searchableFields.Length; i++)
                            {
                                var field = searchableFields[i];
                                <option value="@field" selected="@(field == searchCol)">@searchableNames[i]</option>
                            }
                        }
                    </select>
                </div>
                <div class="col-md-2">
                    <button id="btnSearch" class="btn icon-btn my-1 my-lg-0">
                        <i class="mdi mdi-magnify"></i>
                    </button>
              
                </div>
                <div class="col-md-2 ms-auto d-flex justify-content-end">
                    <select class="form-select my-1 my-lg-0" id="pageSize" style="border-radius: 11px; background: linear-gradient(135deg, #f8fbff, #ffffff);">
                        @{
                            int[] pageSizes = { 1, 10, 20, 50, 100 };
                            foreach (var size in pageSizes)
                            {
                                <option value="@size" selected="@(size == pageSize)">@size</option>
                            }
                        }
                    </select>
                </div>
            </div>

            <div class="table-responsive row align-items-center p-2 mt-2 mb-2" style="background:rgba(255, 255, 255, 0.08); border-radius: 9px; border: 1px solid #b1d8ff; backdrop-filter: blur(12px);
                 -webkit-backdrop-filter: blur(12px); border-radius: 16px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2); color: white;">
            <table class="table table-bordered table-hover table-xl mt-2">
                
                
                <thead>
                    <tr style="background: #f3f7f9;color:black">
                        <th style="color:black">Sl No</th>
                        <th style ="color:black">
                            <a href="javascript:void(0)" style="color:black"  onclick="sortTable('MenuName')" class="d-flex justify-content-between">
                                Menu
                                @(sortColumn == "MenuName" ? (sortDir == "ASC" ? "↑" : "↓") : "↕")
                            </a>
                        </th>
                        <th >Modules</th>
                        <th style="color:black">
                            <a href="javascript:void(0)" style="color:black" onclick="sortTable('CreatedDate')" class="d-flex justify-content-between">
                                Created Date
                                @(sortColumn == "CreatedDate" ? (sortDir == "ASC" ? "↑" : "↓") : "↕")
                            </a>
                        </th>
                        <th style="color:black">Action</th>
                    </tr>
                </thead>

            
                <tbody>
                    @{
                        int count = ((pageNumber - 1) * pageSize) + 1;
                        foreach (var m in modules)
                        {
                            <tr>
                                <td>@count</td>
                                <td class="text-body fw-semibold">@m.MenuName</td>
                                <td>
                                    @{
                                        if (!string.IsNullOrEmpty(m.Modules))
                                        {
                                            var modulesList = m.Modules.Split(',');
                                            foreach (var moduleName in modulesList)
                                            {
                                                <span class="badge module-badge  me-1">@moduleName.Trim()</span>
                                            }
                                        }
                                    }
                                </td>

                                <td>@(m.CreatedDate?.ToString("dd-MM-yyyy"))</td>
                                <td>
                                  
                                        <a href="javascript:;" class="action-icon" onclick="openEditModal(@m.MenuModuleID)">
                                        <i class="mdi mdi-square-edit-outline" data-toggle="tooltip" title="Edit" style="color:rebeccapurple"></i></a>

                                        <a href="javascript:;"
                                           class="action-icon"
                                           onclick="openEditModal(@m.MenuModuleID); $('#btnSavemenu').hide();$('#saveActionBtn').hide();">
                                            <i class="mdi mdi-eye-circle-outline" data-toggle="tooltip" title="View" style="color:#fd683b"></i>
                                        </a>

                                  
                                </td>
                            </tr>
                            count++;
                        }
                        if (!modules.Any())
                        {
                            <tr><td colspan="5" class="text-center text-muted">No records found</td></tr>
                        }
                    }
                </tbody>

            </table>

            <!-- Pagination -->
            <nav>
                <ul class="pagination">
                    <li class="page-item @(pageNumber==1?"disabled":"")">
                        <a class="page-link" href="javascript:void(0)" data-page="@(pageNumber - 1)">Prev</a>
                    </li>

                    @for (int i = startPage; i <= endPage; i++)
                    {
                        <li class="page-item @(i==pageNumber?"active":"")">
                            <a class="page-link" href="javascript:void(0)" data-page="@i">@i</a>
                        </li>
                    }

                    <li class="page-item @(pageNumber>=totalPages?"disabled":"")">
                        <a class="page-link" href="javascript:void(0)" data-page="@(pageNumber + 1)">Next</a>
                    </li>
                </ul>
            </nav>

    </div>



        </div>
    </div>

</div>


<div class="modal fade" id="moduleSetupModal" tabindex="-1" aria-labelledby="moduleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border-0 shadow-sm rounded-3">
            <div class="modal-header text-white border-0 rounded-top py-2" style="background: linear-gradient(135deg, #5ba1ff, #f2747499);">
                <h5 class="modal-title" id="moduleModalLabel">Create Modules Setup :: New</h5>
                <button type="button"
                        class="btn btn-light btn-close-circle shadow-sm"
                        onclick="window.location.href='/ModuleSetup/Index'">
                    <i class="bi bi-x-lg"></i>
                </button>


            </div>

            <div class="modal-body">

            <form id="menuModuleForm">
                <div class="modal-body p-3 bg-light">
                    <input asp-for="MenuModuleID" type="hidden" id="hdnMenuModuleID" />

                    <!-- Accordion -->
                    <div class="accordion" id="menuModuleAccordion">

                        <!-- MENU SECTION -->
                        
                            <div class="accordion-item mb-2">
                            <h2 class="accordion-header" id="menuHeading">
                                <button class="accordion-button fw-bold py-2" style="border-radius: 6px;"
                                        type="button" data-bs-toggle="collapse"
                                        data-bs-target="#menuCollapse"
                                        aria-expanded="true"
                                        aria-controls="menuCollapse">
                                    Menu Details
                                </button>
                            </h2>



                            <div id="menuCollapse" class="accordion-collapse collapse show" aria-labelledby="menuHeading">
                                <div class="accordion-body p-3 bg-white rounded-3 shadow-sm border">
                                    <div class="row g-2">
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold small">Menu Name</label>
                                            <input type="text" id="MenuName" class="form-control form-control-sm" placeholder="Enter Menu Name" />
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold small">Sequence</label>
                                            <input type="number" id="MenuSeq" class="form-control form-control-sm" placeholder="Seq" />
                                        </div>
                                        <div class="col-md-12">
                                            <label class="form-label fw-semibold small">Menu Icon</label>
                                            <input type="text" id="MenuSymbol" class="form-control form-control-sm mb-1" placeholder="Select Icon" readonly />
                                            <div class="icon-scroll-container">
                                                <div class="icons-list-demo d-flex flex-nowrap" id="iconList">
                                                        <div class="icon-item mx-1" title="Home"><i class="fe-home" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Shield"><i class="fe-shield" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Settings"><i class="fe-settings" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="User"><i class="fe-user" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Bell"><i class="fe-bell" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Star"><i class="fe-star" style="margin-left:11px"></i></div>

                                                        <!-- Added more icons -->
                                                        <div class="icon-item mx-1" title="Mail"><i class="fe-mail" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Calendar"><i class="fe-calendar" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Search"><i class="fe-search" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Camera"><i class="fe-camera" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Heart"><i class="fe-heart" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Message"><i class="fe-message-circle" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Cloud"><i class="fe-cloud" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Map"><i class="fe-map" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Lock"><i class="fe-lock" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Power"><i class="fe-power" style="margin-left:11px"></i></div>

                                                        <!-- Even more icons -->
                                                        <div class="icon-item mx-1" title="Edit"><i class="fe-edit" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Trash"><i class="fe-trash" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Download"><i class="fe-download" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Upload"><i class="fe-upload" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="File"><i class="fe-file" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Folder"><i class="fe-folder" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Clipboard"><i class="fe-clipboard" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Tag"><i class="fe-tag" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Shopping Cart"><i class="fe-shopping-cart" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Credit Card"><i class="fe-credit-card" style="margin-left:11px"></i></div>

                                                        <!-- Navigation & Media -->
                                                        <div class="icon-item mx-1" title="Play"><i class="fe-play" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Pause"><i class="fe-pause" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Volume"><i class="fe-volume-2" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Mute"><i class="fe-volume-x" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Music"><i class="fe-music" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Video"><i class="fe-video" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Image"><i class="fe-image" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Sliders"><i class="fe-sliders" style="margin-left:11px"></i></div>

                                                        <!-- Interface / System -->
                                                        <div class="icon-item mx-1" title="Menu"><i class="fe-menu" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Grid"><i class="fe-grid" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="List"><i class="fe-list" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Refresh"><i class="fe-refresh-cw" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Repeat"><i class="fe-repeat" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Check"><i class="fe-check" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="X"><i class="fe-x" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Arrow Left"><i class="fe-arrow-left" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Arrow Right"><i class="fe-arrow-right" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Arrow Up"><i class="fe-arrow-up" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Arrow Down"><i class="fe-arrow-down" style="margin-left:11px"></i></div>

                                                        <!-- Status / Info -->
                                                        <div class="icon-item mx-1" title="Info"><i class="fe-info" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Alert"><i class="fe-alert-triangle" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Help"><i class="fe-help-circle" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Check Circle"><i class="fe-check-circle" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="X Circle"><i class="fe-x-circle" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Activity"><i class="fe-activity" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Sun"><i class="fe-sun" style="margin-left:11px"></i></div>
                                                        <div class="icon-item mx-1" title="Moon"><i class="fe-moon" style="margin-left:11px"></i></div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- MODULE SECTION -->
                        <div class="accordion-item mb-2">
                            <h2 class="accordion-header" id="moduleHeading">
                                <button class="accordion-button collapsed fw-bold py-2" style="border-radius: 6px;" type="button" data-bs-toggle="collapse" data-bs-target="#moduleCollapse" aria-expanded="false" aria-controls="moduleCollapse">
                                    Module Details
                                </button>
                            </h2>
                            <div id="moduleCollapse" class="accordion-collapse collapse" aria-labelledby="moduleHeading">
                                <div class="accordion-body p-3 bg-white rounded-3 shadow-sm border">
                                    <div class="row g-2 align-items-end">
                                        <div class="col-md-4">
                                            <label class="form-label fw-semibold small">Module Name</label>
                                            <input type="text" id="ModuleName" class="form-control form-control-sm" placeholder="Enter Module Name" />
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label fw-semibold small">Module URL</label>
                                            <input type="text" id="ModuleUrl" class="form-control form-control-sm" placeholder="Enter Module URL" />
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label fw-semibold small">Seq</label>
                                            <input type="number" id="ModuleSeq" class="form-control form-control-sm" placeholder="Seq" />
                                        </div>
                                        <div class="col-md-2">
                                            <button type="button" class="btn btn-primary w-100 btn-sm" id="addModuleBtn">Add</button>
                                        </div>
                                    </div>

                                    <div class="table-responsive mt-2">
                                        <table class="table table-hover table-bordered align-middle mb-0 table-sm" id="moduleTable">
                                            <thead class="table-light">
                                                <tr>
                                                    <th style="display:none">ModuleId</th>
                                                    <th>Seq</th>
                                                    <th>Name</th>
                                                    <th>URL</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </form>

            </div>

                <div class="modal-footer border-0 pt-1 d-flex justify-content-between">
                    <button type="button"
                            onclick="window.location.href='/ModuleSetup/Index'"
                            class="btn btn-warning btn-sm"
                            data-bs-dismiss="modal">
                        <i class="mdi mdi-close-circle-outline me-1"></i> Cancel
                    </button>

                    <button type="button" id="btnSavemenu" class="btn btn-sm" style="background:forestgreen; color:white">
                        <i class="mdi mdi-content-save-outline me-1"></i> Save
                    </button>
                </div>

            
        </div>
    </div>
</div>


<div class="modal fade" id="actionSetupModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content gradient-border">
            <div class="modal-header">
                <h5 class="modal-title">Action Setup</h5>
                <button type="button" class="btn btn-light btn-close-circle shadow-sm" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="modalContent">Select an action:</p>
                <div class="d-flex mb-2">
                    <select id="actionDropdown" class="form-select me-2">
                        <option value="">--Select Action--</option>
                    </select>
                    <button type="button" class="btn btn-primary" id="addActionBtn">Add</button>
                </div>
                <div id="selectedActions" class="d-flex flex-wrap gap-2">
                    <!-- Selected action buttons appear here -->
                </div>
            </div>
           

            <div class="modal-footer border-0 pt-1 d-flex justify-content-between">
                <button type="button"   
                        class="btn btn-warning btn-sm"
                        data-bs-dismiss="modal">
                    <i class="mdi mdi-close-circle-outline me-1"></i> Cancel
                </button>

                <button type="button" id="saveActionBtn" class="btn btn-sm" style="background:forestgreen; color:white">
                    <i class="mdi mdi-content-save-outline me-1"></i> Save
                </button>
            </div>
        </div>
    </div>
</div>







@section Scripts {
    
    <script>

 
        // Pagination and filtiring ---------------------------------------------------------------------


        (function () {
            const searchInput = document.getElementById('searchBox');
            const searchField = document.getElementById('searchField');
            const pageSizeSelect = document.getElementById('pageSize');
            const btnSearch = document.getElementById('btnSearch');

            const current = {
                pageNumber: @pageNumber,
                pageSize: @pageSize,
                search: "@search",
                searchCol: "@searchCol",
                sortColumn: "@sortColumn",
                sortDir: "@sortDir"
            };

            function buildUrl(params) {
                const qs = new URLSearchParams();
                qs.set('pageNumber', params.pageNumber ?? 1);
                qs.set('pageSize', params.pageSize ?? current.pageSize);
                if ((params.search ?? current.search) !== '') qs.set('search', params.search ?? current.search);
                qs.set('searchCol', params.searchCol ?? current.searchCol);
                qs.set('sortColumn', params.sortColumn ?? current.sortColumn);
                qs.set('sortDir', params.sortDir ?? current.sortDir);
                return '@Url.Action("Index", "ModuleSetup")' + '?' + qs.toString();
            }

            function navigateTo(opts) { window.location.href = buildUrl(opts); }

            // Search button click
            btnSearch?.addEventListener('click', () => {
                navigateTo({
                    pageNumber: 1,
                    search: searchInput.value,
                    searchCol: searchField.value,
                    pageSize: parseInt(pageSizeSelect.value, 10),
                    sortColumn: current.sortColumn,
                    sortDir: current.sortDir
                });
            });

            // Page size change
            pageSizeSelect?.addEventListener('change', () => {
                navigateTo({
                    pageNumber: 1,
                    search: searchInput.value,
                    searchCol: searchField.value,
                    pageSize: parseInt(pageSizeSelect.value, 10),
                    sortColumn: current.sortColumn,
                    sortDir: current.sortDir
                });
            });

            // Pagination links
            document.querySelectorAll('.pagination a.page-link').forEach(el => {
                el.addEventListener('click', ev => {
                    ev.preventDefault();
                    const page = parseInt(el.dataset.page, 10) || 1;
                    navigateTo({
                        pageNumber: page,
                        search: searchInput.value,
                        searchCol: searchField.value,
                        pageSize: parseInt(pageSizeSelect.value, 10),
                        sortColumn: current.sortColumn,
                        sortDir: current.sortDir
                    });
                });
            });

            // Sorting
            window.sortTable = function (column) {
                let newDir = current.sortColumn === column && current.sortDir === 'ASC' ? 'DESC' : 'ASC';
                navigateTo({
                    pageNumber: 1,
                    search: searchInput.value,
                    searchCol: searchField.value,
                    pageSize: parseInt(pageSizeSelect.value, 10),
                    sortColumn: column,
                    sortDir: newDir
                });
            };
        })();
        document.addEventListener("DOMContentLoaded", function () {
            const icons = document.querySelectorAll(".icon-item");
            const input = document.getElementById("MenuSymbol");

            icons.forEach(icon => {
                icon.addEventListener("click", function () {
                    // remove previous selection
                    icons.forEach(i => i.classList.remove("selected"));
                    this.classList.add("selected");

                    // extract class name
                    const iconClass = this.querySelector("i").className.trim();
                    input.value = iconClass;
                });
            });
        });


        // Pagination and filtiring ---------------------------------------------------------------------




</script>
    <script>
        // Preloader hide on page load
        window.addEventListener('load', function () {
            const preloader = document.getElementById('preloader');
            if (preloader) {
                preloader.classList.add('hidden');
                setTimeout(() => preloader.remove(), 600); // removes after fade-out
            }
        });
    </script>
    <script src="~/js/ModuleSetup.js"></script>

}